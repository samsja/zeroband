project: zeroband
command:
  - ${env}                # wandb injects env vars/API key
  - uv run torchrun --local-ranks-filter 0 --nproc_per_node=1 src/zeroband/train.py @ configs/14M.toml
  - --total_steps=2200
  - --data.batch_size=256
  - --lr.scheduler.warmup_steps=250
  - --lr.scheduler.decay_steps=200
  - ${args}


method: bayes             

parameters:
  optim.lr:
    distribution: log_uniform_values
    min: 0.00001  # 1e-5
    max: 0.1      # 1e-1

metric:                   # which curve the scheduler watches
  name: train/loss
  goal: minimize